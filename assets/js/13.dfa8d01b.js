(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{366:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[s("a",{attrs:{href:"https://github.com/Meituan-Dianping/mpvue",target:"_blank",rel:"noopener noreferrer"}},[t._v("MPVue"),s("OutboundLink")],1),t._v(" 是一个使用 Vue.js 开发小程序的前端框架。框架基于 Vue.js 核心，修改了 Vue.js 的 runtime 和 compiler 实现，使其可以运行在小程序环境中，从而为小程序开发引入了整套 Vue.js 开发体验，同样也使得一套代码同时复用在小程序和 Web 中成为可能。")])]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述","aria-hidden":"true"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("本文将以 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite",target:"_blank",rel:"noopener noreferrer"}},[t._v("IT之家Lite"),s("OutboundLink")],1),t._v(" 小程序的 Web 转换经过为线索，大致介绍一下转换的基本步骤及需要注意的一些事项。")]),t._v(" "),s("h2",{attrs:{id:"目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构","aria-hidden":"true"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("blockquote",[s("p",[t._v("省略了部分与转换无关的文件")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("├─build\n├─config\n├─src\n│ ├─components\n│ ├─pages\n│ ├─store\n│ ├─styles\n│ ├─utils\n│ │  ├─api.js\n│ │  ├─index.js\n│ │  ├─request.js\n│ │  └─wx.js\n│ ├─App.vue\n│ └─main.js\n├─package-lock.json\n└─package.json\n")])])]),s("h2",{attrs:{id:"转换步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#转换步骤","aria-hidden":"true"}},[t._v("#")]),t._v(" 转换步骤")]),t._v(" "),s("p",[t._v("0.前期准备")]),t._v(" "),s("ul",[s("li",[t._v("建议使用 git 进行分支管理")]),t._v(" "),s("li",[t._v("尽量避免使用不必要的小程序特有标签，如 text，image 等 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/9137744e25000cbaa82529639976b3ddea3b5f1b",target:"_blank",rel:"noopener noreferrer"}},[t._v("#9137744"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("避免直接使用 wx 对象，使用 "),s("code",[t._v("import wx from 'wx'")]),t._v(" 的方式引入，便于 web 中改写 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/c3ef6e771dc6e767fed9316fd62bed53581763f2",target:"_blank",rel:"noopener noreferrer"}},[t._v("#c3ef6e7"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/utils/wx.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" wx\n")])])]),s("ul",[s("li",[t._v("使用 "),s("a",{attrs:{href:"https://github.com/wendux/fly",target:"_blank",rel:"noopener noreferrer"}},[t._v("flyio"),s("OutboundLink")],1),t._v(" 作为请求库，配置 alias 将 flyio 指向 "),s("code",[t._v("flyio/dist/npm/wx")])]),t._v(" "),s("li",[t._v("基于原分支新建 web-version 分支")])]),t._v(" "),s("p",[t._v("1.修改打包配置")]),t._v(" "),s("ul",[s("li",[t._v("可以在原有配置基础上修改，主要涉及 entry、target 及 loader 相关的配置项，这里我直接通过 vue-cli 生成了一个新的项目，复制 build、config 文件夹及 eslint、babel 等的配置文件替换原有配置，使用新项目的 package.json 并做相应修改，新建项目时各选项尽量与原项目保持一致 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/ece3a76590df79a3ee19e2fa0a4c7ce07cb77227",target:"_blank",rel:"noopener noreferrer"}},[t._v("#ece3a76"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("修改 main.js，指定挂载元素，顺利的话，这步之后执行 "),s("code",[t._v("npm run dev")]),t._v(" 便已经可以跑起来了，有报错的话解决相应错误即可")])]),t._v(" "),s("p",[t._v("2.配置路由")]),t._v(" "),s("ul",[s("li",[t._v("添加 vue-router，并进行相应配置，建议使用 history 模式 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/ddf94bca7d432ee7ac436f74ed27b4d6bf482e6e",target:"_blank",rel:"noopener noreferrer"}},[t._v("#ddf94bc"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("修改路由参数获取相关的代码 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/b9491979a07940cfb9dd690fb26833cc71d0184d",target:"_blank",rel:"noopener noreferrer"}},[t._v("#b949197"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("使用 router-link 替换 a 标签，避免页面重载 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/eb092972647bb6d903f02bba3c6e38335d1b8b90",target:"_blank",rel:"noopener noreferrer"}},[t._v("#eb09297"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("3.调整请求接口")]),t._v(" "),s("ul",[s("li",[t._v("配置 alias 将 flyio 指向 "),s("code",[t._v("flyio/dist/npm/fly")])]),t._v(" "),s("li",[t._v("小程序中不会有跨域的问题，但 web 中需配合后端进行请求转发或通过其他方式来解决这一问题 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/f96397539da68b31d05bc7c84b9208b565d3fc55",target:"_blank",rel:"noopener noreferrer"}},[t._v("#f963975"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("4.转换小程序组件及 API")]),t._v(" "),s("ul",[s("li",[t._v("底部导航栏，自己布局实现 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/8d6d98bb477cd001c1f0168b5b13e7a77bdf56cb",target:"_blank",rel:"noopener noreferrer"}},[t._v("#8d6d98b"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-pug extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pug"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[t._v(".nav"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$route.meta.nav"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("a.nav-item"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/pages/news/list"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("img.nav-icon"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$route.name === 'NewsList'\"")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/static/assets/news-active.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("img.nav-icon"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/static/assets/news.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v(".nav-title"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(":"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"{ active: $route.name === 'NewsList' }\"")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("资讯")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("a.nav-item"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/pages/quanzi/list"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("img.nav-icon"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$route.name === 'QuanziList'\"")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/static/assets/quanzi-active.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("img.nav-icon"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/static/assets/quanzi.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v(".nav-title"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(":"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"{ active: $route.name === 'QuanziList' }\"")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("圈子")]),t._v("\n")])])]),s("ul",[s("li",[t._v("rich-text 组件，使用 v-html 实现 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/1945f3f7bbe62b9a6913701910775739ac433909",target:"_blank",rel:"noopener noreferrer"}},[t._v("#1945f3f"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("swiper 组件，使用 "),s("a",{attrs:{href:"https://github.com/zwhGithub/vue-swiper",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-swiper-component"),s("OutboundLink")],1),t._v(" 实现 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/f4a4e1a094d08a274782ef19e0e5361f5d546557",target:"_blank",rel:"noopener noreferrer"}},[t._v("#f4a4e1a"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("toast 及 loading 接口，使用 "),s("a",{attrs:{href:"https://github.com/lin-xin/vue-toast",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue2-toast"),s("OutboundLink")],1),t._v(" 实现 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/cb1d9d3f75e9fbf42d2b98f80a51e124de52a38c",target:"_blank",rel:"noopener noreferrer"}},[t._v("#cb1d9d3"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/utils/wx.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showNavigationBarLoading")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$loading")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'加载中'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hideNavigationBarLoading")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$loading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showToast")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" title "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$toast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("center")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("下拉刷新及上拉加载，使用 "),s("a",{attrs:{href:"https://github.com/stackjie/vue-pull-to",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-pull-to"),s("OutboundLink")],1),t._v(" 实现 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/e23b81067ceca02c43c673eac710b853911afeee",target:"_blank",rel:"noopener noreferrer"}},[t._v("#e23b810"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-pug extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pug"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("#app")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("pull-to"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scroller"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("top-load-method")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"refresh"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("bottom-load-method")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loadmore"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("is-top-bounce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"!!onPullDownRefresh"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("is-bottom-bounce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"!!onReachBottom"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    @"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scroll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"saveScrollPosition"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("keep-alive")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("router-view"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"current"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PullTo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-pull-to'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'App'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  mpType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    PullTo\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      onPullDownRefresh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      onReachBottom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  methods"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("refresh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("loaded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onPullDownRefresh")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loaded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadmore")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("loaded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onReachBottom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loaded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("saveScrollPosition")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" current "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs\n      current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("srcElement"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  watch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$route")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$nextTick")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" current "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onPullDownRefresh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onPullDownRefresh\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onReachBottom "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onReachBottom\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("5.Web 优化")]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("a",{attrs:{href:"https://github.com/jgthms/minireset.css",target:"_blank",rel:"noopener noreferrer"}},[t._v("minireset"),s("OutboundLink")],1),t._v(" 重置浏览器默认样式，部分标签在小程序中的默认样式与浏览器不同，也需进行处理 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/e98f5ba8cdced6cbe0c9a14beb22ecd457884123",target:"_blank",rel:"noopener noreferrer"}},[t._v("#e98f5ba"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("引入 "),s("a",{attrs:{href:"https://github.com/babel/babel/tree/master/packages/babel-polyfill",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-polyfill"),s("OutboundLink")],1),t._v("，提高兼容性 "),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite/commit/c1841663bf56c308229380f4400bd68b4c54b2b3",target:"_blank",rel:"noopener noreferrer"}},[t._v("#c184166"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"维护"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#维护","aria-hidden":"true"}},[t._v("#")]),t._v(" 维护")]),t._v(" "),s("p",[t._v("在初步完成 Web 版的转换之后，便可以再次切换回主分支，后续的 feature 及 bugfix 均在主分支进行，待主分支发版后切换到 web 分支进行一次合并操作，可能会产生少量冲突，但也都会比较容易解决，最后处理下新引入的小程序特性即可，整体而言可维护性还是比较好的")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("整个转换过程还是比较顺利的，主体部分约 1 个多小时完成，相对于小程序，web 的环境更为开放，所以大部分小程序的 api 可以通过各种方式模拟，由于是在两个不同的分支进行，也可以放心地使用各种浏览器端的特性，但是样式及脚本尽量不要直接修改原有代码，可通过 mixin、新建 style 标签等方式实现，避免造成冲突")]),t._v(" "),s("h2",{attrs:{id:"展望"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#展望","aria-hidden":"true"}},[t._v("#")]),t._v(" 展望")]),t._v(" "),s("ul",[s("li",[t._v("双端统一的 UI 库，目前来看只能使用一些简单的 css 类库")]),t._v(" "),s("li",[t._v("更好的路由支持，理想状态下，可以通过 vue-router 的配置文件自动生成各页面的 main.js 文件，并配置 entry，开发 .vue 文件时，可以直接使用 "),s("code",[t._v("this.$route")]),t._v(" "),s("code",[t._v("this.$router")]),t._v(" 及 "),s("code",[t._v("router-link")]),t._v(" 完成相关操作，避免每次手动修改")])]),t._v(" "),s("h2",{attrs:{id:"附"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#附","aria-hidden":"true"}},[t._v("#")]),t._v(" 附")]),t._v(" "),s("ol",[s("li",[t._v("Git 仓库")])]),t._v(" "),s("ul",[s("li",[t._v("IT之家Lite："),s("a",{attrs:{href:"https://github.com/F-loat/ithome-lite",target:"_blank",rel:"noopener noreferrer"}},[t._v("ithome-lite"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("MPVue："),s("a",{attrs:{href:"https://github.com/Meituan-Dianping/mpvue",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("项目模版："),s("a",{attrs:{href:"https://github.com/F-loat/mpvue-quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue-quickstart"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("配置优化："),s("a",{attrs:{href:"https://github.com/F-loat/mpvue-entry",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue-entry"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("路由兼容（谨慎使用）："),s("a",{attrs:{href:"https://github.com/F-loat/mpvue-router-patch",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue-router-patch"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("打包工具（已支持 web 打包）："),s("a",{attrs:{href:"https://github.com/F-loat/mpvue-packager",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue-packager"),s("OutboundLink")],1)])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("Demo")])]),t._v(" "),s("ul",[s("li",[t._v("IT之家Lite Web 版: "),s("a",{attrs:{href:"http://ithome.f-loat.xyz",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://ithome.f-loat.xyz"),s("OutboundLink")],1)])])])},[],!1,null,null,null);a.default=e.exports}}]);