<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端 100 问 (二) | F-loat</title>
    <meta name="description" content="This is my blog">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.76163388.css" as="style"><link rel="preload" href="/assets/js/app.a2760e1e.js" as="script"><link rel="preload" href="/assets/js/7.aa338464.js" as="script"><link rel="preload" href="/assets/js/15.8837e5c8.js" as="script"><link rel="prefetch" href="/assets/js/1.7ffe3bb5.js"><link rel="prefetch" href="/assets/js/10.75b2a0e3.js"><link rel="prefetch" href="/assets/js/11.83b1755d.js"><link rel="prefetch" href="/assets/js/12.fe4a742a.js"><link rel="prefetch" href="/assets/js/13.44c3f50a.js"><link rel="prefetch" href="/assets/js/14.2af64a25.js"><link rel="prefetch" href="/assets/js/16.7544c00c.js"><link rel="prefetch" href="/assets/js/17.0645648f.js"><link rel="prefetch" href="/assets/js/18.1bf0ac12.js"><link rel="prefetch" href="/assets/js/19.cf7e7f2d.js"><link rel="prefetch" href="/assets/js/20.6aab5c1a.js"><link rel="prefetch" href="/assets/js/21.4e02ac21.js"><link rel="prefetch" href="/assets/js/22.e2a57c6c.js"><link rel="prefetch" href="/assets/js/23.43c0f996.js"><link rel="prefetch" href="/assets/js/3.e41d15b7.js"><link rel="prefetch" href="/assets/js/4.01d4ef75.js"><link rel="prefetch" href="/assets/js/5.56638abb.js"><link rel="prefetch" href="/assets/js/6.f85b604f.js"><link rel="prefetch" href="/assets/js/8.2d63d74a.js"><link rel="prefetch" href="/assets/js/9.e034cf66.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76163388.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" data-v-0539f1bd><div data-v-740e207b data-v-0539f1bd><nav class="navbar" data-v-740e207b><div class="container" data-v-740e207b><a href="/" class="router-link-active" data-v-740e207b><span class="navbar-site-name" data-v-740e207b>
          F-loat
        </span></a> <div class="navbar-toggler" data-v-740e207b><svg class="icon" style="font-size:1.2em;" data-v-740e207b data-v-740e207b><title data-v-740e207b data-v-740e207b>menu</title><use xlink:href="#icon-menu" data-v-740e207b data-v-740e207b></use></svg></div> <div class="navbar-links" data-v-740e207b><a href="/" class="navbar-link" data-v-740e207b>
            首页
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-740e207b>
            文章
          </a><a href="/about/" class="navbar-link" data-v-740e207b>
            关于
          </a><a href="https://github.com/F-loat/f-loat.github.io" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-740e207b>
            GitHub
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-740e207b></div></div> <div class="banner" data-v-98d6aa8c data-v-0539f1bd data-v-0539f1bd><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-0539f1bd>
          前端 100 问 (二)
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-6e91a59a data-v-6e91a59a><main class="main" data-v-6e91a59a><div class="post" data-v-6e91a59a data-v-6e91a59a><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2019-07-22
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2019-08-04
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/07/21/hello.html" class="post-link" data-v-4e23451f>
      上一篇 : Hello, World!
    </a> <a href="/posts/2019/07/22/interview-03.html" class="post-link" data-v-4e23451f>
      下一篇 : 前端 100 问 (三)
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><ol start="11"><li>算法手写题</li> <li>JS 异步解决方案的发展历程以及优缺点</li> <li><code>Promise</code> 构造函数是同步执行还是异步执行，那么 <code>then</code> 方法呢</li> <li>情人节福利题，如何实现一个 <code>new</code></li> <li>简单讲解一下 <code>HTTP2</code> 的多路复用</li> <li>对 <code>TCP</code> 三次握手和四次挥手的理解</li> <li>A、B 机器正常连接后，B 机器突然重启，问 A 此时处于 <code>TCP</code> 什么状态</li> <li>React 中 <code>setState</code> 什么时候是同步的，什么时候是异步的</li> <li>React <code>setState</code> 笔试题，下面的代码输出什么</li> <li>介绍下 <code>npm</code> 模块安装机制，为什么输入 <code>npm install</code> 就可以自动安装对应的模块</li></ol> <h2 id="_11-算法手写题"><a href="#_11-算法手写题" aria-hidden="true" class="header-anchor">#</a> 11. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/8" target="_blank" rel="noopener noreferrer">算法手写题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <blockquote><p>已知如下数组：</p> <p>var arr = [[1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14]]]], 10];</p> <p>编写一个程序将数组扁平化去并除其中重复部分数据，最终得到一个升序且不重复的数组</p></blockquote> <p><strong>Array.from(new Set(arr.flat(Infinity))).sort((a,b) =&gt; (a-b))</strong></p> <ul><li><p><code>Array.flat(Infinity)</code> 打平任意层数组</p></li> <li><p><code>Array.flatMap()</code> 对原数组的每个成员执行一个函数，然后对返回值组成的数组执行 <code>flat()</code> 方法，只能打平一层</p></li> <li><p><code>flat</code> 与 <code>flatMap</code> 方法均返回新数组，不会修改原有数组</p></li></ul> <h2 id="_12-js-异步解决方案的发展历程以及优缺点"><a href="#_12-js-异步解决方案的发展历程以及优缺点" aria-hidden="true" class="header-anchor">#</a> 12. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/11" target="_blank" rel="noopener noreferrer">JS 异步解决方案的发展历程以及优缺点<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p><strong>callback -&gt; Promise -&gt; Generator -&gt; Async/await</strong></p> <ul><li><p><code>callback</code> 不能用 <code>try catch</code> 捕获错误，不能 <code>return</code></p></li> <li><p><code>Promise</code> 无法取消，错误需要通过回调函数来捕获</p></li></ul> <h2 id="_13-promise-构造函数是同步执行还是异步执行，那么-then-方法呢"><a href="#_13-promise-构造函数是同步执行还是异步执行，那么-then-方法呢" aria-hidden="true" class="header-anchor">#</a> 13. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/19" target="_blank" rel="noopener noreferrer">Promise 构造函数是同步执行还是异步执行，那么 then 方法呢<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p><strong>构造函数同步，then 方法异步</strong></p> <ul><li><p><code>then</code> 是微任务，会在本次任务执行完的时候执行</p></li> <li><p><code>setTimeout</code> 是宏任务，会在下次任务执行的时候执行</p></li></ul> <h2 id="_14-情人节福利题，如何实现一个-new"><a href="#_14-情人节福利题，如何实现一个-new" aria-hidden="true" class="header-anchor">#</a> 14. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/12" target="_blank" rel="noopener noreferrer">情人节福利题，如何实现一个 new<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <blockquote><p>当代码 new Foo(...) 执行时，会发生以下事情：</p> <ol><li>一个继承自 Foo.prototype 的新对象被创建</li> <li>使用指定的参数调用构造函数 Foo，并将 this 绑定到新创建的对象</li> <li>由构造函数返回的对象就是 new 表达式的结果，如果构造函数没有显式返回一个对象，则使用步骤1创建的对象</li></ol></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> ret <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> ret <span class="token punctuation">:</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15-简单讲解一下-http2-的多路复用"><a href="#_15-简单讲解一下-http2-的多路复用" aria-hidden="true" class="header-anchor">#</a> 15. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/14" target="_blank" rel="noopener noreferrer">简单讲解一下 http2 的多路复用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <ul><li><p><code>HTTP/1</code> 每次请求都会建立一次 HTTP 连接</p></li> <li><p><code>HTTP/1.1</code> 默认开启 <code>keep-alive</code>，但单个连接无法交错请求，且会导致服务端连接数过多</p></li> <li><p><code>HTTP2</code> 同域名下所有通信都在单个连接上完成，单个连接上可以并行交错的请求和响应</p></li></ul> <blockquote><p>HTTP2 的传输是基于二进制帧的。每一个 TCP 连接中承载了多个双向流通的流，每一个流都有一个独一无二的标识和优先级，而流就是由二进制帧组成的。二进制帧的头部信息会标识自己属于哪一个流，所以这些帧是可以交错传输，然后在接收端通过帧头的信息组装成完整的数据。这样就解决了线头阻塞的问题，同时也提高了网络速度的利用率。</p></blockquote> <h2 id="_16-对-tcp-三次握手和四次挥手的理解"><a href="#_16-对-tcp-三次握手和四次挥手的理解" aria-hidden="true" class="header-anchor">#</a> 16. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/15" target="_blank" rel="noopener noreferrer">对 TCP 三次握手和四次挥手的理解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p><strong>三次握手之所以是三次是保证 client 和 server 均让对方知道自己的接收和发送能力没问题而保证的最小次数</strong></p> <blockquote><p>第一次 client =&gt; server，只能 server 判断出 client 具备发送能力
第二次 server =&gt; client，client 就可以判断出 server 具备发送和接受能力。此时 client 还需让 server 知道自己接收能力没问题于是就有了第三次
第三次 client =&gt; server，双方均保证了自己的接收和发送能力没有问题</p> <p>其中，为了保证后续的握手是为了应答上一个握手，每次握手都会带一个标识 seq，后续的 ACK 都会对这个 seq 进行加一来进行确认</p></blockquote> <p><strong><a href="https://juejin.im/post/5c078058f265da611c26c235" target="_blank" rel="noopener noreferrer">作为前端的你了解多少 TCP 的内容<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p> <h2 id="_17-a、b-机器正常连接后，b-机器突然重启，问-a-此时处于-tcp-什么状态"><a href="#_17-a、b-机器正常连接后，b-机器突然重启，问-a-此时处于-tcp-什么状态" aria-hidden="true" class="header-anchor">#</a> 17. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/21" target="_blank" rel="noopener noreferrer">A、B 机器正常连接后，B 机器突然重启，问 A 此时处于 TCP 什么状态<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <blockquote><p>服务器和客户建立连接后，若服务器主机崩溃，有两种可能：</p> <ol><li>服务器不重启，客户继续工作，就会发现对方没有回应(ETIMEOUT)，路由器聪明的话，则是目的地不可达(EHOSTUNREACH)。</li> <li>服务器重启后，客户继续工作，然而服务器已丢失客户信息，收到客户数据后响应RST。</li></ol></blockquote> <p><strong><a href="https://crystalwindz.com/unp_note_1" target="_blank" rel="noopener noreferrer">UNP-网络编程基础<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p> <h2 id="_18-react-中-setstate-什么时候是同步的，什么时候是异步的"><a href="#_18-react-中-setstate-什么时候是同步的，什么时候是异步的" aria-hidden="true" class="header-anchor">#</a> 18. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/17" target="_blank" rel="noopener noreferrer">React 中 setState 什么时候是同步的，什么时候是异步的<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p><strong>在 React 中，如果是由 React 引发的事件处理（比如通过onClick引发的事件处理），调用 setState 不会同步更新 this.state，除此之外的 setState 调用会同步更新 this.state。所谓“除此之外”，指的是绕过 React 通过 addEventListener 直接添加的事件处理函数，还有通过 setTimeout/setInterval 产生的异步调用。</strong></p> <ul><li><p>React 的 <code>setState</code> 函数实现中，会根据变量 <code>isBatchingUpdates</code> 判断是同步还是异步更新 <code>this.state</code>，<code>isBatchingUpdates</code> 默认为 <code>false</code></p></li> <li><p>React 在调用事件处理函数之前会调用 <code>batchedUpdates</code> 函数把 <code>isBatchingUpdates</code> 修改为 <code>true</code>，更新完成后恢复为 <code>false</code></p></li> <li><p>考虑到性能问题，可能会对多次调用作批处理，将多个 <code>nextState</code> 浅合并到当前 <code>state</code>，可在调用 <code>setState</code> 时通过传入函数避免</p></li></ul> <h2 id="_19-react-setstate-笔试题，下面的代码输出什么"><a href="#_19-react-setstate-笔试题，下面的代码输出什么" aria-hidden="true" class="header-anchor">#</a> 19. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/18" target="_blank" rel="noopener noreferrer">React setState 笔试题，下面的代码输出什么<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      val<span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state.val === 0</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第 1 次 log</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state.val === 0</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第 2 次 log</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state.val === 1</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第 3 次 log</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state.val === 2</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第 4 次 log</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>输出：0 0 2 3</strong></p> <ul><li><p>第一次和第二次都是在 react 自身生命周期内，触发时 <code>isBatchingUpdates</code> 为 <code>true</code>，不会直接执行更新 <code>state</code>，而是加入了 <code>dirtyComponents</code></p></li> <li><p>两次 <code>setState</code> 时，获取到 <code>this.state.val</code> 都是 0，所以执行时都是将 0 设置成 1，在 <code>react</code> 内部会被合并掉，只执行一次</p></li> <li><p><code>setTimeout</code> 中的代码，触发时 <code>isBatchingUpdates</code> 为 <code>false</code>，会直接进行更新</p></li></ul> <h2 id="_20-介绍下-npm-模块安装机制，为什么输入-npm-install-就可以自动安装对应的模块"><a href="#_20-介绍下-npm-模块安装机制，为什么输入-npm-install-就可以自动安装对应的模块" aria-hidden="true" class="header-anchor">#</a> 20. <a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/22" target="_blank" rel="noopener noreferrer">介绍下 npm 模块安装机制，为什么输入 npm install 就可以自动安装对应的模块<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <ol><li>npm 模块安装机制：</li></ol> <ul><li>发出 <code>npm install</code> 命令</li> <li>查询 <code>node_modules</code> 目录之中是否已经存在指定模块
<ul><li>若存在，不再重新安装</li> <li>若不存在
<ul><li>npm 向 registry 查询模块压缩包的网址</li> <li>下载压缩包，存放在根目录下的 <code>.npm</code> 目录里</li> <li>解压压缩包到当前项目的 <code>node_modules</code> 目录</li></ul></li></ul></li></ul> <ol start="2"><li><p>npm 实现原理 (v5.5.1)：</p> <ol><li>执行工程自身 preinstall</li> <li>确定首层依赖模块</li> <li>获取模块</li> <li>模块扁平化 (去重)</li> <li>安装模块</li> <li>执行工程自身生命周期</li></ol></li></ol> <blockquote><p>模块安装时模块自身及项目的 <code>pre/post</code> 钩子将按顺序调用</p></blockquote></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2019-07-22
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2019-08-04
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/07/21/hello.html" class="post-link" data-v-4e23451f>
      上一篇 : Hello, World!
    </a> <a href="/posts/2019/07/22/interview-03.html" class="post-link" data-v-4e23451f>
      下一篇 : 前端 100 问 (三)
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-6e91a59a><div class="info-card main-div" data-v-03c72fc4 data-v-6e91a59a><div class="info-card-header" data-v-03c72fc4><img src="https://avatars2.githubusercontent.com/u/16759376?s=460&amp;v=4" alt="徒言" class="info-avatar" data-v-03c72fc4></div> <div class="info-card-body" data-v-03c72fc4><section class="info-nickname" data-v-03c72fc4>
      徒言
    </section> <section class="info-desc" data-v-03c72fc4>Happy Coding<br/>Happy Life</section> <section class="info-contact" data-v-03c72fc4><section data-v-03c72fc4><span title="Tian'jin City, China" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>Tian'jin City, China</title><use xlink:href="#icon-location" data-v-03c72fc4 data-v-03c72fc4></use></svg><span class="info-text" data-v-03c72fc4 data-v-03c72fc4>
          Tian'jin City, China
        </span></span></section> <section data-v-03c72fc4><span title="Youngon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>Youngon</title><use xlink:href="#icon-organization" data-v-03c72fc4 data-v-03c72fc4></use></svg><span class="info-text" data-v-03c72fc4 data-v-03c72fc4>
          Youngon
        </span></span></section> <section data-v-03c72fc4><a href="mailto:chaimaoyuan@foxmail.com" title="chaimaoyuan@foxmail.com" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>chaimaoyuan@foxmail.com</title><use xlink:href="#icon-email" data-v-03c72fc4 data-v-03c72fc4></use></svg><span class="info-text" data-v-03c72fc4 data-v-03c72fc4>
          chaimaoyuan@foxmail.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-03c72fc4><section class="info-sns clearfix" data-v-03c72fc4><a href="https://github.com/F-loat" target="_blank" class="sns-link" data-v-03c72fc4><span title="GitHub: F-loat" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>GitHub: F-loat</title><use xlink:href="#icon-github" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="https://www.facebook.com/chaimaoyuan" target="_blank" class="sns-link" data-v-03c72fc4><span title="Facebook: chaimaoyuan" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>Facebook: chaimaoyuan</title><use xlink:href="#icon-facebook" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="http://www.linkedin.com/in/茂源-柴-a9b290115/" target="_blank" class="sns-link" data-v-03c72fc4><span title="LinkedIn: 柴茂源" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>LinkedIn: 柴茂源</title><use xlink:href="#icon-linkedin" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="https://twitter.com/chaimaoyuan" target="_blank" class="sns-link" data-v-03c72fc4><span title="Twitter: chaimaoyuan" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>Twitter: chaimaoyuan</title><use xlink:href="#icon-twitter" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="https://www.zhihu.com/people/F-loat" target="_blank" class="sns-link" data-v-03c72fc4><span title="知乎: F-loat" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>知乎: F-loat</title><use xlink:href="#icon-zhihu" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="https://www.instagram.com/chaimaoyuan" target="_blank" class="sns-link" data-v-03c72fc4><span title="Instagram: chaimaoyuan" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>Instagram: chaimaoyuan</title><use xlink:href="#icon-instagram" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a><a href="https://gitlab.com/F-loat" target="_blank" class="sns-link" data-v-03c72fc4><span title="GitLab: F-loat" class="sns-icon" data-v-03c72fc4 data-v-03c72fc4><svg class="icon" style="font-size:1.5em;" data-v-03c72fc4 data-v-03c72fc4><title data-v-03c72fc4 data-v-03c72fc4>GitLab: F-loat</title><use xlink:href="#icon-gitlab" data-v-03c72fc4 data-v-03c72fc4></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-6e91a59a><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/posts/2019/07/22/interview-02.html#_11-算法手写题">11. 算法手写题</a></li><li><a href="/posts/2019/07/22/interview-02.html#_12-js-异步解决方案的发展历程以及优缺点">12. JS 异步解决方案的发展历程以及优缺点</a></li><li><a href="/posts/2019/07/22/interview-02.html#_13-promise-构造函数是同步执行还是异步执行，那么-then-方法呢">13. Promise 构造函数是同步执行还是异步执行，那么 then 方法呢</a></li><li><a href="/posts/2019/07/22/interview-02.html#_14-情人节福利题，如何实现一个-new">14. 情人节福利题，如何实现一个 new</a></li><li><a href="/posts/2019/07/22/interview-02.html#_15-简单讲解一下-http2-的多路复用">15. 简单讲解一下 http2 的多路复用</a></li><li><a href="/posts/2019/07/22/interview-02.html#_16-对-tcp-三次握手和四次挥手的理解">16. 对 TCP 三次握手和四次挥手的理解</a></li><li><a href="/posts/2019/07/22/interview-02.html#_17-a、b-机器正常连接后，b-机器突然重启，问-a-此时处于-tcp-什么状态">17. A、B 机器正常连接后，B 机器突然重启，问 A 此时处于 TCP 什么状态</a></li><li><a href="/posts/2019/07/22/interview-02.html#_18-react-中-setstate-什么时候是同步的，什么时候是异步的">18. React 中 setState 什么时候是同步的，什么时候是异步的</a></li><li><a href="/posts/2019/07/22/interview-02.html#_19-react-setstate-笔试题，下面的代码输出什么">19. React setState 笔试题，下面的代码输出什么</a></li><li><a href="/posts/2019/07/22/interview-02.html#_20-介绍下-npm-模块安装机制，为什么输入-npm-install-就可以自动安装对应的模块">20. 介绍下 npm 模块安装机制，为什么输入 npm install 就可以自动安装对应的模块</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2019/07/22/interview-02.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1114308c><p class="sns-links" data-v-1114308c><a href="https://github.com/F-loat" target="_blank" class="sns-link" data-v-1114308c><span title="GitHub: F-loat" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>GitHub: F-loat</title><use xlink:href="#icon-github" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://www.facebook.com/chaimaoyuan" target="_blank" class="sns-link" data-v-1114308c><span title="Facebook: chaimaoyuan" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>Facebook: chaimaoyuan</title><use xlink:href="#icon-facebook" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="http://www.linkedin.com/in/茂源-柴-a9b290115/" target="_blank" class="sns-link" data-v-1114308c><span title="LinkedIn: 柴茂源" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>LinkedIn: 柴茂源</title><use xlink:href="#icon-linkedin" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://twitter.com/chaimaoyuan" target="_blank" class="sns-link" data-v-1114308c><span title="Twitter: chaimaoyuan" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>Twitter: chaimaoyuan</title><use xlink:href="#icon-twitter" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://www.zhihu.com/people/F-loat" target="_blank" class="sns-link" data-v-1114308c><span title="知乎: F-loat" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>知乎: F-loat</title><use xlink:href="#icon-zhihu" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://www.instagram.com/chaimaoyuan" target="_blank" class="sns-link" data-v-1114308c><span title="Instagram: chaimaoyuan" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>Instagram: chaimaoyuan</title><use xlink:href="#icon-instagram" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://gitlab.com/F-loat" target="_blank" class="sns-link" data-v-1114308c><span title="GitLab: F-loat" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>GitLab: F-loat</title><use xlink:href="#icon-gitlab" data-v-1114308c data-v-1114308c></use></svg></span></a></p> <p data-v-1114308c><span data-v-1114308c>Powered by </span> <a href="https://vuepress.vuejs.org" target="_blank" data-v-1114308c>
      Vuepress
    </a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.a2760e1e.js" defer></script><script src="/assets/js/7.aa338464.js" defer></script><script src="/assets/js/15.8837e5c8.js" defer></script>
  </body>
</html>
